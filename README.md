# ONA-Sentiment-Analysis-and-Topic-Clustering-in-Python
This is an Organizational Network Analysis, Sentiment Analysis, and Topic Clustering project that a team of students completed in Python as part of an NYU course in Fall 2019. The authors of this project are Sammie Kim, Toby Du, and Max Needle. As a team, we analyzed the Enron Emails Corpus using sentiment analysis, organizational network analysis (ONA), topic clustering, and a number of visualizations (scatterplots, word clouds, network diagrams, and time series visualizations). We started by extracted data from each email (i.e., date, message, recipient, sender) and incorporating additional information about the job level of the email senders/recipients and Enronâ€™s stock price in the month it was sent. We then calculated the sentiment of each email and the probability that it discussed one the top 5 topics, which we interpreted as 1. Reporting, 2. Revenue, 3. Regulation, 4. Management, and 5. Energy Market. We then did several analyses to assess whether email sentiment and network centrality (degree and betweenness centrality) were different based on the sender's job level group (senior management or other), and we found that the two groups were different in terms of their network degree centrality (senior managers had more links to others in the network) and email sentiment (senior managers' emails were significantly higher in sentiment) but not their network betweenness centrality (senior managers acted as 'bridges' connecting others in the network just as much as other employees did). We also investigated whether the topics discussed in the email (of the top 5 topic clusters) were associated with the email's sentiment or with Enron's stock price in the month it was sent, and we found that, while all topics were correlated with sentiment and stock price (likely because of the large number of emails), Enron's monthly stock price only had small correlations with Topic 1 (interpreted as Reporting; r = 0.06) and Topic 3 (interpreted as Regulation; r = -0.05). On the other hand, the email's sentiment had a medium-sized correlation with Topic 2 (interpreted as Revenue; r = -0.19) and small correlations with Topic 3 (interpreted as Regulation; r = 0.09) and Topic 4 (interpreted as Management; r = 0.05). Since the visualizations take up too much space in the "Enron Compiled.ipynb" script, a pdf copy of the script ("Enron Compiled.pdf") includes the visualizations.

# About the supporting data
The Enron Email corpus (https://www.cs.cmu.edu/~enron/) was collected and prepared by the CALO Project (A Cognitive Assistant that Learns and Organizes). It contains data from about 150 users, mostly senior management of Enron, organized into folders. The corpus contains a total of about 0.5M messages. This data was originally made public, and posted to the web, by the Federal Energy Regulatory Commission during its investigation.

# Instructions to Run
To run the "Enron Compiled.ipynb" script, you will need to install and load several Python packages (pandas, numpy, seaborn, matplotlib, scipy, sklearn, statsmodel, nltk, glob, os, email.parser, afinn, wordcloud, datetime, networkx, collections, re, pingouin, researchpy, plotly, textblob, statistics, itertools, and wget). Warning: to run this entire script will take several hours.
