# ONA-Sentiment-Analysis-and-Topic-Clustering-in-Python
This is an Organizational Network Analysis, Sentiment Analysis, and Topic Clustering project that a team of students completed in Python as part of an NYU course in Fall 2019. The authors of this project are Sammie Kim, Toby Du, and Max Needle. As a team, we analyzed the Enron Emails Corpus using sentiment analysis, organizational network analysis (ONA), topic clustering, and a number of visualizations (scatterplots, word clouds, network diagrams, interaction mean plots, and time series visualizations). We started by extracted data from each email (i.e., date, message, recipient, sender) and incorporating additional information about the job level of the email senders/recipients and Enronâ€™s stock price in the month it was sent. We then did several analyses to assess whether email sentiment or network centrality (degree and betweenness centrality) were different based on the sender's job level group (management or other), and we found that . We also investigated whether there were correlations between the topics discussed in the email (of the top 5 topic clusters), its sentiment, and Enron's stock price in the month it was sent, and we found that .

# About the supporting data
The Enron Email corpus (https://www.cs.cmu.edu/~enron/) was collected and prepared by the CALO Project (A Cognitive Assistant that Learns and Organizes). It contains data from about 150 users, mostly senior management of Enron, organized into folders. The corpus contains a total of about 0.5M messages. This data was originally made public, and posted to the web, by the Federal Energy Regulatory Commission during its investigation.

# Instructions to Run
To run the "Enron Compiled.ipynb" script, you will need to install and load several Python packages (pandas, numpy, seaborn, matplotlib, scipy, sklearn, statsmodel, nltk, glob, os, email.parser, afinn, wordcloud, datetime, networkx, collections, re, pingouin, researchpy, plotly, textblob, statistics, and wget). For your ease, " " contains a pandas dataframe with all the information about each email, including date, sender, recipient, subject and message, job level of sender and recipient (if known), sentiment of subject/message, and stock price in the month it was sent, and you can skip this processing stage by starting to run the script at the header "Reload master df". 
